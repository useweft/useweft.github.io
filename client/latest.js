!function(){"use strict";var e=document.currentScript,t=e&&e.getAttribute("data-api")||"https://api.useweft.dev",n=!(e&&"false"===e.getAttribute("data-observe")),r=document.createElement("style");r.id="useweft-cloak",r.textContent="body{visibility:hidden!important}",(document.head||document.documentElement).appendChild(r);var o=setTimeout(u,3e3);function u(){clearTimeout(o),r.parentNode&&r.parentNode.removeChild(r)}function c(){for(var e=Object.create(null),t=document.querySelectorAll("[class]"),n=0;n<t.length;n++)for(var r=t[n].classList,o=0;o<r.length;o++)e[r[o]]=1;return Object.keys(e).sort()}var i=null;function a(e,t){var n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onload=n.onerror=t||null,l(n)}function l(e){i&&i.parentNode&&i.parentNode.removeChild(i),i=e,document.head.appendChild(e)}var s=null;var d=null;function f(){return s?Promise.resolve(s):fetch(t+"/v").then(function(e){if(!e.ok)throw new Error(e.status);return e.json()}).then(function(e){return s=e.v,e.v}).catch(function(e){return console.warn("[useweft] version fetch failed, using fallback",e),s="unknown"})}function h(e){return e.length?f().then(function(n){return function(e,t){var n=e+"\n"+t.join(",");return crypto.subtle.digest("SHA-256",(new TextEncoder).encode(n)).then(function(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++)t+=(n[r]<16?"0":"")+n[r].toString(16);return"b_"+t.slice(0,16)})}(n,e).then(function(n){if(n!==d){var r=t+"/css/"+n;return function(e){try{return localStorage.getItem(e)}catch(e){return null}}("useweft:"+n)?(d=n,void a(r,u)):fetch(t+"/compile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classes:e})}).then(function(e){if(!e.ok)throw new Error(e.status);return e.json()}).then(function(e){var n,r,o;if(d=e.bundleId,e.css?(n=e.css,r=u,(o=document.createElement("style")).textContent=n,l(o),r&&r()):a(t+"/css/"+e.bundleId,u),function(e,t){try{localStorage.setItem(e,t)}catch(e){}}("useweft:"+e.bundleId,"1"),e.css){var c=document.createElement("link");c.rel="prefetch",c.href=t+"/css/"+e.bundleId,document.head.appendChild(c)}}).catch(function(e){console.warn("[useweft]",e),u()})}})}):(u(),Promise.resolve())}var m=null;function v(){n&&"undefined"!=typeof MutationObserver&&new MutationObserver(function(e){for(var t=0;t<e.length;t++){var n=e[t];if("attributes"===n.type&&"class"===n.attributeName||"childList"===n.type&&n.addedNodes.length)return clearTimeout(m),void(m=setTimeout(function(){h(c())},200))}}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"],childList:!0,subtree:!0})}function p(){h(c()).then(v)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",p):p()}();